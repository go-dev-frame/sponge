<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgNjQgNjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODdDRUVCIiBzdHJva2Utd2lkdGg9IjYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTUxLjksNEgxMi4xQzcuNiw0LDQsNy42LDQsMTIuMXYzOS43QzQsNTYuNCw3LjYsNjAsMTIuMSw2MGgzOS43YzQuNSwwLDguMS0zLjYsOC4xLTguMVYxMi4xQzYwLDcuNiw1Ni40LDQsNTEuOSw0eiIvPjxwYXRoIGQ9Ik0xMiwzMmg4LjdsNC44LTExLjJMMzQsNDRsNi4zLTE2LjhsNC45LDUuOEg1MiIvPjwvZz48L3N2Zz4="><title>Perftest分布式集群性能测试</title><script src="appConfig.js"></script><script src="chart.js"></script><style>:root{--primary-color:#4361ee;--primary-light:#4895ef;--success-color:#4cc9f0;--warning-color:#f72585;--danger-color:#e63946;--dark-color:#212529;--light-color:#f8f9fa;--gray-color:#6c757d;--border-radius:12px;--box-shadow:0 8px 30px rgba(0,0,0,.08);--transition:all .3s ease}*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,'Helvetica Neue',sans-serif}body{background-color:#f0f2f5;background:linear-gradient(135deg,#8ec5fc 0,#e0c3fc 100%);color:#333;line-height:1.6;padding-bottom:40px}.container{max-width:1400px;margin:0 auto;padding:20px}header{display:flex;align-items:center;justify-content:space-between;gap:25px;margin-bottom:30px;padding:25px 40px;color:#fff;border-radius:var(--border-radius);background:rgba(255,255,255,.1);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 32px 0 rgba(31,38,135,.17)}.header-content{display:flex;align-items:center;gap:25px}.header-icon{flex-shrink:0;width:60px;height:60px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,.15);border-radius:50%}.header-icon svg{width:32px;height:32px;fill:#fff}.header-text{text-align:left}header h1{color:#fff;margin-bottom:8px;font-weight:700;font-size:2.2rem;text-shadow:0 2px 8px rgba(0,0,0,.2)}header p{color:rgba(255,255,255,.85);font-size:1.1rem;font-weight:400}.lang-switcher-dropdown{position:relative;display:inline-block}.lang-toggle-btn{display:flex;align-items:center;background:rgba(255,255,255,.15);color:#fff;border:1px solid rgba(255,255,255,.3);border-radius:8px;padding:8px 16px;cursor:pointer;font-weight:600;transition:background .3s ease}.lang-toggle-btn:hover{background:rgba(255,255,255,.3)}.lang-options{display:none;position:absolute;right:0;top:calc(100% + 5px);background-color:#fff;min-width:120px;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);z-index:1;border-radius:8px;overflow:hidden;animation:fadeIn .2s ease-out}@keyframes fadeIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.lang-options a{color:#000;padding:12px 16px;text-decoration:none;display:block;text-align:left;transition:background-color .2s}.lang-options a:hover{background-color:#f1f1f1}.lang-options.show{display:block}.card{background:#fff;border-radius:var(--border-radius);padding:30px;margin-bottom:30px;box-shadow:var(--box-shadow);transition:var(--transition)}.card:hover{transform:translateY(-5px);box-shadow:0 12px 40px rgba(0,0,0,.12)}.card h2{color:var(--dark-color);margin-bottom:20px;font-weight:600;font-size:1.8rem;position:relative;padding-bottom:10px}.card h2::after{content:'';position:absolute;bottom:0;left:0;width:60px;height:4px;background:linear-gradient(to right,var(--primary-color),var(--primary-light));border-radius:2px}.control-panel{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px;margin-bottom:30px;margin-top:30px}.input-group{display:flex;align-items:center;gap:12px}label{margin-bottom:0;font-weight:600;color:var(--dark-color);font-size:.95rem;white-space:nowrap}input[type=number]{width:90%;padding:12px 15px;border:2px solid #e1e5eb;border-radius:8px;font-size:16px;transition:var(--transition);background-color:#f8f9fa}input[type=number]:focus{border-color:var(--primary-color);outline:0;box-shadow:0 0 0 3px rgba(67,97,238,.15)}.button-group{display:flex;flex-wrap:wrap;gap:15px;align-items:center}.btn{padding:12px 20px;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:var(--transition);font-size:.95rem;letter-spacing:.5px;text-transform:uppercase}.btn-primary{background:linear-gradient(135deg,var(--primary-color),var(--primary-light));color:#fff}.btn-primary:hover:not(:disabled){background:linear-gradient(135deg,#3a56d4,#3d8be0);transform:translateY(-2px)}.btn-danger{background:linear-gradient(135deg,#f72585,#b5179e);color:#fff}.btn-danger:hover:not(:disabled){background:linear-gradient(135deg,#e01e79,#a0148a);transform:translateY(-2px)}.btn-success{background:linear-gradient(135deg,#4cc9f0,#4895ef);color:#fff}.btn-success:hover:not(:disabled){background:linear-gradient(135deg,#3db8df,#3784de);transform:translateY(-2px)}.btn:disabled{background:var(--gray-color);cursor:not-allowed;transform:none;opacity:.7}.test-info-grid{display:grid;grid-template-columns:1fr 1fr;gap:30px;margin-top:30px;padding-top:30px;border-top:1px solid #ecf0f1}@media (max-width:768px){.test-info-grid{grid-template-columns:1fr}}.test-info-grid h4{font-size:1.2rem;color:var(--dark-color);margin-bottom:15px;padding-bottom:10px;border-bottom:2px solid var(--primary-color);font-weight:600}.test-info-grid p{font-size:1rem;color:#555;margin-bottom:12px;display:flex;align-items:center}.test-info-grid p span{margin-left:8px}#test-id-display{font-weight:600;color:var(--primary-color);word-break:break-all;background-color:rgba(67,97,238,.1);padding:4px 8px;border-radius:4px}#test-method,#test-url{font-weight:600;color:var(--dark-color);word-break:break-all;background-color:#f8f9fa;padding:4px 8px;border-radius:4px}#test-status{font-weight:700;font-size:1.1rem;margin-top:15px;padding:10px;border-radius:6px;text-align:center}.status-pending{color:var(--warning-color);background-color:rgba(247,37,133,.1)}.status-running{color:var(--primary-color);background-color:rgba(67,97,238,.1)}.status-completed{color:var(--success-color);background-color:rgba(76,201,240,.1)}.status-stopped{color:var(--danger-color);background-color:rgba(230,57,70,.1)}.dashboard{display:grid;grid-template-columns:1fr 1fr;gap:30px;margin-bottom:30px}@media (max-width:992px){.dashboard{grid-template-columns:1fr}}.chart-container{position:relative;height:350px;margin-bottom:20px;background-color:#fff;border-radius:12px;padding:20px;box-shadow:0 4px 15px rgba(0,0,0,.05)}.metrics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:30px;margin-bottom:30px}.metric-card{background:linear-gradient(145deg,#fff,#eef1fa);border-radius:16px;padding:25px;box-shadow:0 6px 20px rgba(0,0,0,.06);transition:var(--transition);position:relative;overflow:hidden;border:none}.metric-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:4px;background:linear-gradient(90deg,var(--primary-color),var(--primary-light))}.metric-card:nth-child(2n)::before{background:linear-gradient(90deg,var(--success-color),var(--primary-light))}.metric-card:nth-child(3n)::before{background:linear-gradient(90deg,var(--warning-color),#b5179e)}.metric-card:nth-child(4n)::before{background:linear-gradient(90deg,#3a0ca3,var(--primary-color))}.metric-card:hover{transform:translateY(-7px);box-shadow:0 12px 30px rgba(0,0,0,.12);background:linear-gradient(145deg,#fff,#f0f7ff)}.metric-card h3{font-size:1.1rem;color:var(--gray-color);margin-bottom:15px;font-weight:500;display:flex;align-items:center}.metric-card h3::before{content:'';display:inline-block;width:8px;height:8px;border-radius:50%;background-color:var(--primary-color);margin-right:8px}.metric-card:nth-child(2n) h3::before{background-color:var(--success-color)}.metric-card:nth-child(3n) h3::before{background-color:var(--warning-color)}.metric-card:nth-child(4n) h3::before{background-color:#3a0ca3}.metric-card .value{font-size:2rem;font-weight:700;color:var(--dark-color);display:flex;align-items:baseline;margin-top:5px;position:relative}.data-unit{font-size:1.2rem;color:var(--gray-color);margin-left:5px;font-weight:500}.section-title{margin:30px 0 20px;padding-bottom:10px;border-bottom:2px solid var(--primary-color);color:var(--dark-color);font-size:1.4rem;font-weight:600}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);z-index:1000;justify-content:center;align-items:center;backdrop-filter:blur(5px)}.modal-content{background-color:#fff;padding:40px;border-radius:16px;max-width:500px;width:100%;text-align:center;box-shadow:0 15px 50px rgba(0,0,0,.2);animation:modalFadeIn .3s ease}@keyframes modalFadeIn{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.modal-content h2{color:var(--dark-color);margin-bottom:15px;font-size:1.8rem}.modal-content p{color:#555;margin-bottom:25px;font-size:1.1rem}.modal-buttons{display:flex;justify-content:center;gap:20px;margin-top:30px}.restore-notice{background-color:#e8f4fd;border-left:4px solid var(--primary-color);padding:15px 20px;margin-bottom:25px;border-radius:8px;display:none;font-weight:500;color:var(--dark-color);animation:noticeFadeIn .5s ease}@keyframes noticeFadeIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.data-unit{font-size:1rem;color:var(--gray-color);margin-left:5px}#error-details-container{margin-top:30px;background-color:#fff;border-radius:12px;padding:20px;box-shadow:0 4px 15px rgba(0,0,0,.05)}.data-table{width:100%;border-collapse:collapse;margin-top:15px}.data-table td,.data-table th{padding:12px 15px;text-align:left;border-bottom:1px solid #eee}.data-table th{background-color:#f8f9fa;font-weight:600;color:var(--dark-color)}.data-table tr:last-child td{border-bottom:none}.data-table tr:hover td{background-color:#f8f9fa}.help-icon{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;background-color:#4aacef;color:#fff;border-radius:50%;font-size:12px;font-weight:700;cursor:help;position:relative;margin-left:5px}.tooltip{position:absolute;background-color:#eff;color:#fff;padding:8px 12px;border-radius:4px;font-size:14px;width:220px;z-index:1000;opacity:0;visibility:hidden;transition:opacity .3s,visibility .3s;bottom:100%;left:50%;transform:translateX(-50%);margin-bottom:8px;box-shadow:0 2px 10px rgba(0,0,0,.2)}.tooltip::after{content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);border-width:5px;border-style:solid;border-color:#eed transparent transparent transparent}.help-icon .icon{pointer-events:none}.help-icon:hover .tooltip{opacity:1;visibility:visible}.tooltip a{color:var(--primary-color);text-decoration:none}.tooltip a:hover{text-decoration:underline}</style></head><body><div class="container"><div class="restore-notice" id="restore-notice" data-lang-key="restoreNotice">检测到未完成的测试，正在恢复状态...</div><header><div class="header-content"><div class="header-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg></div><div class="header-text"><h1 data-lang-key="mainTitle">Perftest分布式集群性能测试</h1><p data-lang-key="subtitle">实时监控分布式集群性能测试的各项指标</p></div></div><div class="lang-switcher-dropdown"><button id="lang-toggle-btn" class="lang-toggle-btn"><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" name="i18n" style="width:1rem;height:1rem;vertical-align:middle;--darkreader-inline-fill:currentColor" data-darkreader-inline-fill=""><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="stroke:#fff;stroke-width:3;margin-left:3px"><path d="M6 9L12 15L18 9" stroke-linecap="round" stroke-linejoin="round"/></svg></button><div id="lang-options" class="lang-options"><a href="#" data-lang="zh">中文</a><a href="#" data-lang="en">English</a></div></div></header><div class="card"><h2 data-lang-key="controlTitle">测试控制</h2><div class="control-panel"><div class="input-group"><label for="agent-num"><span data-lang-key="agentNumLabel">集群 Agent 节点数</span><span class="help-icon"><span class="icon">?</span><span class="tooltip"><a href="https://github.com/go-dev-frame/sponge/blob/main/cmd/sponge/commands/perftest/readme-cn.md#集群压测示例" target="_blank" data-lang-key="agentDeployLink">Agent 部署说明</a></span></span></label><input type="number" id="agent-num" min="1" value="3"></div><div class="button-group"><button id="create-test" class="btn btn-primary" data-lang-key="createTestBtn">开始测试</button><button id="stop-test" class="btn btn-danger" disabled="disabled" data-lang-key="stopTestBtn">停止测试</button><button id="download-report" class="btn btn-success" disabled="disabled" data-lang-key="downloadReportBtn">下载测试报告</button></div></div><div class="test-info-grid"><div class="test-status-section"><h4 data-lang-key="statusTitle">状态</h4><p>Test ID:<span id="test-id-display">N/A</span></p><div id="test-status" data-lang-key="statusInitial">等待开始</div><div id="agent-status"></div></div><div class="test-target-section"><h4 data-lang-key="targetTitle">测试目标</h4><p>Method:<span id="test-method">N/A</span></p><p>URL:<span id="test-url">N/A</span></p></div></div></div><div class="card"><h2 data-lang-key="realtimeDataTitle">实时性能数据</h2><div class="dashboard"><div><h3 class="section-title" data-lang-key="qpsChartTitle">吞吐量 (QPS)</h3><div class="chart-container"><canvas id="qps-chart"></canvas></div></div><div><h3 class="section-title" data-lang-key="latencyChartTitle">延时 (Latency)</h3><div class="chart-container"><canvas id="latency-chart"></canvas></div></div></div><div class="dashboard"><div><h3 class="section-title" data-lang-key="dataTransferChartTitle">数据传输 (Data Transfer)</h3><div class="chart-container"><canvas id="data-transfer-chart"></canvas></div></div><div><h3 class="section-title" data-lang-key="statusCodesChartTitle">HTTP状态码分布 (Status Codes)</h3><div class="chart-container"><canvas id="status-codes-chart"></canvas></div></div></div><h3 class="section-title" data-lang-key="keyMetricsTitle">关键指标</h3><div class="metrics-grid"><div class="metric-card"><h3 data-lang-key="totalRequests">总请求数 (Total Requests)</h3><div class="value" id="total-requests">0</div></div><div class="metric-card"><h3 data-lang-key="successCount">成功数 (Success)</h3><div class="value" id="success-count">0</div></div><div class="metric-card"><h3 data-lang-key="errorCount">失败数 (Errors)</h3><div class="value" id="error-count">0</div></div><div class="metric-card"><h3 data-lang-key="totalDuration">测试时长 (Duration)</h3><div class="value" id="total-duration">0<span class="data-unit">s</span></div></div><div class="metric-card"><h3 data-lang-key="avgLatency">平均延时 (Avg Latency)</h3><div class="value" id="avg-latency">0<span class="data-unit">ms</span></div></div><div class="metric-card"><h3 data-lang-key="qpsValue">吞吐量 (QPS)</h3><div class="value" id="qps-value">0<span class="data-unit">req/s</span></div></div></div><div id="error-details-container" style="display:none"><h3 class="section-title" data-lang-key="errorDetailsTitle">错误详情</h3><table class="data-table" id="error-details-table"><thead><tr><th data-lang-key="errorMsgHeader">错误信息</th></tr></thead><tbody id="error-details"></tbody></table></div></div></div><div class="modal" id="completion-modal"><div class="modal-content"><h2 data-lang-key="modalTitle">测试完成</h2><p data-lang-key="modalText">测试已完成，是否立即下载Markdown格式报告？</p><div class="modal-buttons"><button id="modal-download" class="btn btn-success" data-lang-key="modalDownloadBtn">下载报告</button><button id="modal-close" class="btn btn-primary" data-lang-key="modalCloseBtn">关闭</button></div></div></div><script>const translations={zh:{pageTitle:"Perftest分布式集群性能测试",mainTitle:"Perftest分布式集群性能测试",subtitle:"实时监控分布式集群性能测试的各项指标",restoreNotice:"没有发现未完成的测试，显示上一次测试结果",restoreNoticeRecovered:id=>`已恢复测试会话 (ID: ${id})`,restoreNoticeLastStatus:(status,id)=>`上一次测试状态: ${status}，可以下载报告 (ID: ${id})`,restoreNoticeLastStatusSimple:(status,id)=>`上一次测试状态: ${status} (ID: ${id})`,restoreNoticeFailed:"恢复测试状态失败，请重新开始测试",controlTitle:"测试控制",agentNumLabel:"集群 Agent 节点数",agentDeployLink:"Agent 部署说明",createTestBtn:"开始测试",stopTestBtn:"停止测试",downloadReportBtn:"下载测试报告",statusTitle:"状态",statusInitial:"等待开始",statusCreating:"正在开始测试...",statusCreateFailed:"开始测试失败",statusWaitingAgents:num=>`等待 Agent 节点连接... (${num})`,statusWaitingAgentsWithCount:(registered,expected)=>`等待 Agent 节点连接... (${registered}/${expected})`,statusStopped:"测试已停止",statusRunning:"测试正在运行...",statusCompleted:"测试完成",statusAborted:"测试已中止",statusUnknown:status=>`未知状态 ${status}`,targetTitle:"测试目标",realtimeDataTitle:"实时性能数据",qpsChartTitle:"吞吐量 (QPS)",latencyChartTitle:"延时 (Latency)",dataTransferChartTitle:"数据传输 (Data Transfer)",statusCodesChartTitle:"HTTP状态码分布 (Status Codes)",keyMetricsTitle:"关键指标",totalRequests:"总请求数 (Total Requests)",successCount:"成功数 (Success)",errorCount:"失败数 (Errors)",totalDuration:"测试时长 (Duration)",avgLatency:"平均延时 (Avg Latency)",qpsValue:"吞吐量 (QPS)",errorDetailsTitle:"错误详情",errorMsgHeader:"错误信息",noErrors:"无错误",modalTitle:"测试完成",modalText:"测试已完成，是否立即下载Markdown格式报告？",modalDownloadBtn:"下载报告",modalCloseBtn:"关闭",alertInvalidAgentNum:"请输入有效的 Agent 数量",alertNoActiveTest:"没有活动的测试",alertStopFailed:"停止测试失败: 测试可能已经完成或不存在",alertGetReportFailed:status=>`获取报告失败: ${status}`,alertCreateFailed:status=>`创建测试失败: ${status}`,alertStopReqFailed:status=>`停止测试失败: ${status}`,alertStopGeneric:msg=>`停止测试失败: ${msg}`,alertCreateGeneric:msg=>`创建测试失败: ${msg}`,alertNoReportData:"没有可用的报告数据",chartQpsAxisY:"请求数/秒",chartTimeAxisX:"时间 (秒)",chartLatencyAxisY:"延时 (ms)",chartLatencyLegendAvg:"平均",chartLatencyLegendP50:"P50",chartLatencyLegendP95:"P95",chartLatencyLegendP99:"P99",chartDataTransferAxisY:"数据量 (Bytes)",chartDataTransferLegendSent:"发送数据量",chartDataTransferLegendReceived:"接收数据量",chartStatusCodesAxisY:"请求数量",chartStatusCodesAxisX:"HTTP状态码",chartStatusCodesLegend:"状态码数量",markdownContent:data=>`> ${data.createdAt} TestID: ${data.testId}\n\n## 分布式集群性能测试报告\n\n### [测试目标]\n- **Method**: ${data.targetMethod}\n- **URL**: ${data.targetURL}\n\n### [Agent节点与状态]\n${data.agentStatusList}\n\n### [请求概览]\n- **总请求数:** ${data.totalRequests}\n- **成功请求:** ${data.successCount} (${data.successPercentage}%)\n- **失败请求:** ${data.errorCount}\n- **总测试时长:** ${data.totalDuration} s\n- **吞吐量 (QPS):** ${data.qps} req/sec\n\n### [延迟统计]\n- **平均值:** ${data.avgLatency} ms\n- **最小值:** ${data.minLatency} ms\n- **最大值:** ${data.maxLatency} ms\n- **P25:** ${data.p25Latency} ms\n- **P50:** ${data.p50Latency} ms\n- **P95:** ${data.p95Latency} ms\n- **P99:** ${data.p99Latency} ms\n\n### [数据传输]\n- **发送总量:** ${data.totalSent} bytes\n- **接收总量:** ${data.totalReceived} bytes\n\n### [HTTP状态码分布]\n${data.statusCodesList}\n### [错误详情]\n${data.errorList}\n`},en:{pageTitle:"Perftest Distributed Cluster Performance Testing",mainTitle:"Perftest Distributed Cluster Performance Testing",subtitle:"Real-time monitoring of metrics for distributed cluster performance testing",restoreNotice:"No unfinished tests were found, display the previous test result",restoreNoticeRecovered:id=>`Test session recovered (ID: ${id})`,restoreNoticeLastStatus:(status,id)=>`Last test status: ${status}, report is available for download (ID: ${id})`,restoreNoticeLastStatusSimple:(status,id)=>`Last test status: ${status} (ID: ${id})`,restoreNoticeFailed:"Failed to restore test state, please restart test",controlTitle:"Test Control",agentNumLabel:"Number of Cluster Agent Nodes",agentDeployLink:"Agent Deployment Guide",createTestBtn:"Start Test",stopTestBtn:"Stop Test",downloadReportBtn:"Download Report",statusTitle:"Status",statusInitial:"Waiting to start",statusCreating:"Starting test...",statusCreateFailed:"Failed to start test",statusWaitingAgents:num=>`Waiting for Agent nodes to connect... (${num})`,statusWaitingAgentsWithCount:(registered,expected)=>`Waiting for Agent nodes to connect... (${registered}/${expected})`,statusStopped:"Test stopped",statusRunning:"Test is running...",statusCompleted:"Test completed",statusAborted:"Test aborted",statusUnknown:status=>`Unknown status ${status}`,targetTitle:"Test Target",realtimeDataTitle:"Real-time Performance Data",qpsChartTitle:"Throughput (QPS)",latencyChartTitle:"Latency",dataTransferChartTitle:"Data Transfer",statusCodesChartTitle:"HTTP Status Codes Distribution",keyMetricsTitle:"Key Metrics",totalRequests:"Total Requests",successCount:"Success",errorCount:"Errors",totalDuration:"Duration",avgLatency:"Avg Latency",qpsValue:"Throughput (QPS)",errorDetailsTitle:"Error Details",errorMsgHeader:"Error Message",noErrors:"No errors",modalTitle:"Test Completed",modalText:"The test is complete. Download the report in Markdown format now?",modalDownloadBtn:"Download",modalCloseBtn:"Close",alertInvalidAgentNum:"Please enter a valid number of Agents",alertNoActiveTest:"No active test found",alertStopFailed:"Failed to stop test: It may already be completed or does not exist",alertGetReportFailed:status=>`Failed to get report: ${status}`,alertCreateFailed:status=>`Failed to create test: ${status}`,alertStopReqFailed:status=>`Failed to stop test: ${status}`,alertStopGeneric:msg=>`Failed to stop test: ${msg}`,alertCreateGeneric:msg=>`Failed to create test: ${msg}`,alertNoReportData:"No report data available",chartQpsAxisY:"Requests/sec",chartTimeAxisX:"Time (s)",chartLatencyAxisY:"Latency (ms)",chartLatencyLegendAvg:"Average",chartLatencyLegendP50:"P50",chartLatencyLegendP95:"P95",chartLatencyLegendP99:"P99",chartDataTransferAxisY:"Data (Bytes)",chartDataTransferLegendSent:"Data Sent",chartDataTransferLegendReceived:"Data Received",chartStatusCodesAxisY:"Number of Requests",chartStatusCodesAxisX:"HTTP Status Code",chartStatusCodesLegend:"Status Code Count",markdownContent:data=>`> ${data.createdAt} TestID: ${data.testId}\n\n## Distributed Cluster Performance Test Report\n\n### [Test Target]\n- **Method**: ${data.targetMethod}\n- **URL**: ${data.targetURL}\n\n### [Agent Nodes and Status]\n${data.agentStatusList}\n\n### [Requests Overview]\n- **Total Requests:** ${data.totalRequests}\n- **Successful:** ${data.successCount} (${data.successPercentage}%)\n- **Failed:** ${data.errorCount}\n- **Total Duration:** ${data.totalDuration} s\n- **Throughput (QPS):** ${data.qps} req/sec\n\n### [Latency Statistics]\n- **Average:** ${data.avgLatency} ms\n- **Minimum:** ${data.minLatency} ms\n- **Maximum:** ${data.maxLatency} ms\n- **P25:** ${data.p25Latency} ms\n- **P50:** ${data.p50Latency} ms\n- **P95:** ${data.p95Latency} ms\n- **P99:** ${data.p99Latency} ms\n\n### [Data Transfer]\n- **Sent:** ${data.totalSent} bytes\n- **Received:** ${data.totalReceived} bytes\n\n### [HTTP Status Codes Distribution]\n${data.statusCodesList}\n### [Error Details]\n${data.errorList}\n`}};let currentLanguage='zh';let testId=null;let pollingInterval=null;let qpsChart=null;let latencyChart=null;let dataTransferChart=null;let statusCodesChart=null;let qpsData=[];let latencyData={avg:[],p50:[],p95:[],p99:[]};let dataTransferData={sent:[],received:[]};let statusCodesData={};let timeLabels=[];let lastReportData=null;const HOST=appConfig.perftestServiceAddr;const agentNumInput=document.getElementById('agent-num');const createTestBtn=document.getElementById('create-test');const stopTestBtn=document.getElementById('stop-test');const downloadReportBtn=document.getElementById('download-report');const testStatusDiv=document.getElementById('test-status');const agentStatusDiv=document.getElementById('agent-status');const completionModal=document.getElementById('completion-modal');const modalDownloadBtn=document.getElementById('modal-download');const modalCloseBtn=document.getElementById('modal-close');const restoreNotice=document.getElementById('restore-notice');const langToggleBtn=document.getElementById('lang-toggle-btn');const langOptions=document.getElementById('lang-options');function setLanguage(lang){currentLanguage=lang;document.documentElement.lang=lang==='zh'?'zh-CN':'en';document.querySelectorAll('[data-lang-key]').forEach(el=>{const key=el.getAttribute('data-lang-key');if(translations[lang][key]){if(typeof translations[lang][key]!=='function'){el.textContent=translations[lang][key]}}});document.title=translations[lang].pageTitle;localStorage.setItem('perftest_language',lang);[qpsChart,latencyChart,dataTransferChart,statusCodesChart].forEach(chart=>{if(chart)chart.destroy()});initCharts();if(lastReportData){updateUI(lastReportData)}else{testStatusDiv.textContent=translations[currentLanguage].statusInitial}}function initCharts(){const lang=currentLanguage;const qpsCtx=document.getElementById('qps-chart').getContext('2d');qpsChart=new Chart(qpsCtx,{type:'line',data:{labels:timeLabels,datasets:[{label:'QPS',data:qpsData,borderColor:'#4361ee',backgroundColor:'rgba(67, 97, 238, 0.1)',borderWidth:2,fill:true,tension:0.4,pointRadius:1,pointHoverRadius:5}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,title:{display:true,text:translations[lang].chartQpsAxisY}},x:{title:{display:true,text:translations[lang].chartTimeAxisX}}}}});const latencyCtx=document.getElementById('latency-chart').getContext('2d');latencyChart=new Chart(latencyCtx,{type:'line',data:{labels:timeLabels,datasets:[{label:translations[lang].chartLatencyLegendAvg,data:latencyData.avg,borderColor:'#4361ee',backgroundColor:'rgba(67, 97, 238, 0.1)',borderWidth:2,fill:false,tension:0.4,pointRadius:1,pointHoverRadius:5},{label:translations[lang].chartLatencyLegendP50,data:latencyData.p50,borderColor:'#4cc9f0',backgroundColor:'rgba(76, 201, 240, 0.1)',borderWidth:2,fill:false,tension:0.4,pointRadius:1,pointHoverRadius:5},{label:translations[lang].chartLatencyLegendP95,data:latencyData.p95,borderColor:'#f72585',backgroundColor:'rgba(247, 37, 133, 0.1)',borderWidth:2,fill:false,tension:0.4,pointRadius:1,pointHoverRadius:5},{label:translations[lang].chartLatencyLegendP99,data:latencyData.p99,borderColor:'#7209b7',backgroundColor:'rgba(114, 9, 183, 0.1)',borderWidth:2,fill:false,tension:0.4,pointRadius:1,pointHoverRadius:5}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,title:{display:true,text:translations[lang].chartLatencyAxisY}},x:{title:{display:true,text:translations[lang].chartTimeAxisX}}}}});const dataTransferCtx=document.getElementById('data-transfer-chart').getContext('2d');dataTransferChart=new Chart(dataTransferCtx,{type:'line',data:{labels:timeLabels,datasets:[{label:translations[lang].chartDataTransferLegendSent,data:dataTransferData.sent,borderColor:'#4361ee',backgroundColor:'rgba(67, 97, 238, 0.1)',borderWidth:2,fill:true,tension:0.4,pointRadius:1,pointHoverRadius:5},{label:translations[lang].chartDataTransferLegendReceived,data:dataTransferData.received,borderColor:'#4cc9f0',backgroundColor:'rgba(76, 201, 240, 0.1)',borderWidth:2,fill:true,tension:0.4,pointRadius:1,pointHoverRadius:5}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,title:{display:true,text:translations[lang].chartDataTransferAxisY}},x:{title:{display:true,text:translations[lang].chartTimeAxisX}}}}});const statusCodesCtx=document.getElementById('status-codes-chart').getContext('2d');statusCodesChart=new Chart(statusCodesCtx,{type:'bar',data:{labels:Object.keys(statusCodesData),datasets:[{label:translations[lang].chartStatusCodesLegend,data:Object.values(statusCodesData),backgroundColor:['rgba(67, 97, 238, 0.7)','rgba(76, 201, 240, 0.7)','rgba(247, 37, 133, 0.7)','rgba(230, 57, 70, 0.7)','rgba(114, 9, 183, 0.7)','rgba(58, 12, 163, 0.7)'],borderColor:['rgb(67, 97, 238)','rgb(76, 201, 240)','rgb(247, 37, 133)','rgb(230, 57, 70)','rgb(114, 9, 183)','rgb(58, 12, 163)'],borderWidth:1}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,title:{display:true,text:translations[lang].chartStatusCodesAxisY}},x:{title:{display:true,text:translations[lang].chartStatusCodesAxisX}}}}})}function saveState(){const state={testId,agentNum:agentNumInput.value,qpsData,latencyData,dataTransferData,statusCodesData,timeLabels,lastReportData};localStorage.setItem('perftest_state',JSON.stringify(state))}function restoreState(){const savedState=localStorage.getItem('perftest_state');if(savedState){try{const state=JSON.parse(savedState);testId=state.testId;agentNumInput.value=state.agentNum||3;if(state.qpsData)qpsData=state.qpsData;if(state.timeLabels)timeLabels=state.timeLabels;if(state.latencyData)latencyData=state.latencyData;if(state.dataTransferData)dataTransferData=state.dataTransferData;if(state.statusCodesData)statusCodesData=state.statusCodesData;if(qpsChart&&qpsData.length>0){qpsChart.data.labels=timeLabels;qpsChart.data.datasets[0].data=qpsData;qpsChart.update()}if(latencyChart&&latencyData.avg&&latencyData.avg.length>0){latencyChart.data.labels=timeLabels;latencyChart.data.datasets[0].data=latencyData.avg;latencyChart.data.datasets[1].data=latencyData.p50||[];latencyChart.data.datasets[2].data=latencyData.p95||[];latencyChart.data.datasets[3].data=latencyData.p99||[];latencyChart.update()}if(dataTransferChart&&dataTransferData.sent&&dataTransferData.sent.length>0){dataTransferChart.data.labels=timeLabels;dataTransferChart.data.datasets[0].data=dataTransferData.sent;dataTransferChart.data.datasets[1].data=dataTransferData.received;dataTransferChart.update()}if(statusCodesChart&&statusCodesData){updateStatusCodesChart(statusCodesData)}if(state.lastReportData){lastReportData=state.lastReportData;updateUI(state.lastReportData)}if(testId){document.getElementById('test-id-display').textContent=testId;restoreNotice.textContent=translations[currentLanguage].restoreNotice;restoreNotice.style.display='block';setTimeout(()=>{restoreNotice.style.display='none';},3000);}else{restoreTestState();}}catch(e){console.error('Failed to restore state:',e);localStorage.removeItem('perftest_state')}}}async function restoreTestState(){if(!testId)return;try{const response=await fetch(`${HOST}/tests/${testId}/report`);if(!response.ok)throw new Error(translations[currentLanguage].alertGetReportFailed(response.status));const data=await response.json();lastReportData=data;updateUI(data);if(data.status==='pending'||data.status==='running'){createTestBtn.disabled=true;stopTestBtn.disabled=false;downloadReportBtn.disabled=true;startPolling();restoreNotice.textContent=translations[currentLanguage].restoreNoticeRecovered(testId)}else{resetButtonStates();if(data.status==='completed'||data.status==='stopped'){downloadReportBtn.disabled=false;restoreNotice.textContent=translations[currentLanguage].restoreNoticeLastStatus(data.status,testId)}else{restoreNotice.textContent=translations[currentLanguage].restoreNoticeLastStatusSimple(data.status,testId)}setTimeout(()=>{restoreNotice.style.display='none'},3e3)}}catch(error){console.error('Error restoring test state:',error);stopPolling();resetButtonStates();updateTestStatus("aborted",0,0);saveState();setTimeout(()=>{restoreNotice.style.display='none'},3e3)}}function resetUIAndData(){qpsData=[];latencyData={avg:[],p50:[],p95:[],p99:[]};dataTransferData={sent:[],received:[]};statusCodesData={};timeLabels=[];lastReportData=null;if(qpsChart){qpsChart.data.labels=timeLabels;qpsChart.data.datasets[0].data=qpsData;qpsChart.update()}if(latencyChart){latencyChart.data.labels=timeLabels;latencyChart.data.datasets[0].data=latencyData.avg;latencyChart.data.datasets[1].data=latencyData.p50;latencyChart.data.datasets[2].data=latencyData.p95;latencyChart.data.datasets[3].data=latencyData.p99;latencyChart.update()}if(dataTransferChart){dataTransferChart.data.labels=timeLabels;dataTransferChart.data.datasets[0].data=dataTransferData.sent;dataTransferChart.data.datasets[1].data=dataTransferData.received;dataTransferChart.update()}if(statusCodesChart){statusCodesChart.data.labels=[];statusCodesChart.data.datasets[0].data=[];statusCodesChart.update()}document.getElementById('total-requests').textContent='0';document.getElementById('success-count').textContent='0';document.getElementById('error-count').textContent='0';document.getElementById('total-duration').innerHTML='0 <span class="data-unit">s</span>';document.getElementById('avg-latency').innerHTML='0 <span class="data-unit">ms</span>';document.getElementById('qps-value').innerHTML='0 <span class="data-unit">req/s</span>';document.getElementById('test-id-display').textContent='N/A';document.getElementById('test-method').textContent='N/A';document.getElementById('test-url').textContent='N/A';document.getElementById('error-details-container').style.display='none';document.getElementById('error-details').innerHTML='';testStatusDiv.textContent=translations[currentLanguage].statusInitial;testStatusDiv.className='';agentStatusDiv.textContent=''}async function createTest(){resetUIAndData();const agentNum=agentNumInput.value;if(!agentNum||agentNum<1){alert(translations[currentLanguage].alertInvalidAgentNum);return}try{createTestBtn.disabled=true;downloadReportBtn.disabled=true;testStatusDiv.textContent=translations[currentLanguage].statusCreating;const response=await fetch(`${HOST}/tests?agent_num=${agentNum}`,{method:'POST'});if(!response.ok)throw new Error(translations[currentLanguage].alertCreateFailed(response.status));const data=await response.json();testId=data.test_id;document.getElementById('test-id-display').textContent=testId;testStatusDiv.textContent=translations[currentLanguage].statusWaitingAgents(data.agent_num);agentStatusDiv.textContent='';stopTestBtn.disabled=false;saveState();startPolling()}catch(error){console.error('Create test error:',error);alert(translations[currentLanguage].alertCreateGeneric(error.message));createTestBtn.disabled=false;testStatusDiv.textContent=translations[currentLanguage].statusCreateFailed}}async function stopTest(){if(!testId){alert(translations[currentLanguage].alertNoActiveTest);return}try{stopTestBtn.disabled=true;const response=await fetch(`${HOST}/tests/${testId}/stop`,{method:'POST'});if(response.status===200){testStatusDiv.textContent=translations[currentLanguage].statusStopped;testStatusDiv.className='status-stopped';saveState()}else if(response.status===409||response.status===404){testStatusDiv.textContent=translations[currentLanguage].statusStopped;testStatusDiv.className='status-stopped'}else{throw new Error(translations[currentLanguage].alertStopReqFailed(response.status))}}catch(error){console.error('Stop test error:',error);alert(translations[currentLanguage].alertStopGeneric(error.message));stopTestBtn.disabled=false}}function resetButtonStates(){createTestBtn.disabled=false;stopTestBtn.disabled=true;downloadReportBtn.disabled=true}function startPolling(){if(pollingInterval)clearInterval(pollingInterval);pollingInterval=setInterval(fetchReport,1e3)}function stopPolling(){if(pollingInterval){clearInterval(pollingInterval);pollingInterval=null}}async function fetchReport(){if(!testId)return;try{const response=await fetch(`${HOST}/tests/${testId}/report`);if(!response.ok)throw new Error(translations[currentLanguage].alertGetReportFailed(response.status));const data=await response.json();lastReportData=data;if((data.status==='completed'||data.status==='stopped')&&pollingInterval){if(data.report)updateCharts(data.report)}updateUI(data);saveState();if(data.status!=='pending'&&data.status!=='running'){stopPolling();resetButtonStates();if(data.status==='completed'||data.status==='stopped')downloadReportBtn.disabled=false;if(data.status==='completed')showCompletionModal()}}catch(error){stopPolling();resetButtonStates();updateTestStatus("aborted",0,0);console.error('Fetch report error:',error)}}function updateUI(data){const report=data.report||{};updateTestStatus(data.status,data.registered_agents,data.expected_agents);document.getElementById('test-method').textContent=report.method||document.getElementById('test-method').textContent;document.getElementById('test-url').textContent=report.url||document.getElementById('test-url').textContent;document.getElementById('total-requests').textContent=report.total_requests||0;document.getElementById('success-count').textContent=report.success_count||0;const errorCountValue=report.error_count||0;document.getElementById('error-count').textContent=errorCountValue;document.getElementById('total-duration').innerHTML=`${report.total_duration||0} <span class="data-unit">s</span>`;document.getElementById('avg-latency').innerHTML=`${report.avg_latency||0} <span class="data-unit">ms</span>`;document.getElementById('qps-value').innerHTML=`${report.qps?report.qps.toFixed(1):0} <span class="data-unit">req/s</span>`;const errorDetailsContainer=document.getElementById('error-details-container');errorDetailsContainer.style.display=errorCountValue>0?'block':'none';updateErrorDetails(report.errors);if(data.status==='running'&&report){updateCharts(report)}}function updateTestStatus(status,registered,expected){testStatusDiv.className='';const lang=currentLanguage;switch(status){case'pending':testStatusDiv.textContent=translations[lang].statusWaitingAgentsWithCount(registered,expected);testStatusDiv.classList.add('status-pending');break;case'running':testStatusDiv.textContent=translations[lang].statusRunning;testStatusDiv.classList.add('status-running');break;case'completed':testStatusDiv.textContent=translations[lang].statusCompleted;testStatusDiv.classList.add('status-completed');break;case'stopped':testStatusDiv.textContent=translations[lang].statusStopped;testStatusDiv.classList.add('status-stopped');break;case'aborted':testStatusDiv.textContent=translations[lang].statusAborted;testStatusDiv.classList.add('status-stopped');break;default:testStatusDiv.textContent=translations[lang].statusUnknown(status)}}function updateErrorDetails(errors){const tbody=document.getElementById('error-details');tbody.innerHTML='';if(!errors||errors.length===0){const row=document.createElement('tr');row.innerHTML=`<td>${translations[currentLanguage].noErrors}</td>`;tbody.appendChild(row);return}errors.forEach(error=>{const row=document.createElement('tr');row.innerHTML=`<td>${error}</td>`;tbody.appendChild(row)})}function updateCharts(report){qpsData.push(report.qps||0);const elapsedTime=timeLabels.length;timeLabels.push(elapsedTime.toString());if(timeLabels.length>180){timeLabels.shift();qpsData.shift();if(latencyData.avg)latencyData.avg.shift();if(latencyData.p50)latencyData.p50.shift();if(latencyData.p95)latencyData.p95.shift();if(latencyData.p99)latencyData.p99.shift();if(dataTransferData.sent)dataTransferData.sent.shift();if(dataTransferData.received)dataTransferData.received.shift()}latencyData.avg.push(report.avg_latency||0);latencyData.p50.push(report.p50_latency||0);latencyData.p95.push(report.p95_latency||0);latencyData.p99.push(report.p99_latency||0);dataTransferData.sent.push(report.total_sent||0);dataTransferData.received.push(report.total_received||0);if(report.status_codes)statusCodesData=report.status_codes;qpsChart.data.labels=timeLabels;qpsChart.data.datasets[0].data=qpsData;qpsChart.update();latencyChart.data.labels=timeLabels;latencyChart.data.datasets[0].data=latencyData.avg;latencyChart.data.datasets[1].data=latencyData.p50;latencyChart.data.datasets[2].data=latencyData.p95;latencyChart.data.datasets[3].data=latencyData.p99;latencyChart.update();dataTransferChart.data.labels=timeLabels;dataTransferChart.data.datasets[0].data=dataTransferData.sent;dataTransferChart.data.datasets[1].data=dataTransferData.received;dataTransferChart.update();updateStatusCodesChart(statusCodesData)}function updateStatusCodesChart(statusCodes){if(!statusCodes)return;statusCodesChart.data.labels=Object.keys(statusCodes);statusCodesChart.data.datasets[0].data=Object.values(statusCodes);statusCodesChart.update()}function showCompletionModal(){completionModal.style.display='flex'}function hideCompletionModal(){completionModal.style.display='none'}function parseAgentStatus(statusString){try{if(!statusString)return"Unable to get node status";const statusData=JSON.parse(statusString);let result="";if(statusData.finished&&Array.isArray(statusData.finished)){statusData.finished.forEach(agentId=>{result+=`- **${agentId}**: finished\n`})}for(const[status,agents]of Object.entries(statusData)){if(status!=='finished'&&Array.isArray(agents)){agents.forEach(agentId=>{result+=`- ${agentId}     ${status}\n`})}}if(result.endsWith('\n')){result=result.slice(0,-1)}return result||"No node status information"}catch(e){console.error('Failed to parse agent status',e);return"Failed to parse node status"}}function downloadReport(){if(!lastReportData){alert(translations[currentLanguage].alertNoReportData);return}const report=lastReportData.report||{};const totalRequests=report.total_requests||0;const successCount=report.success_count||0;const reportData={createdAt:report.created_at||new Date().toISOString(),testId:report.id||'Unknown ID',targetMethod:report.method||'N/A',targetURL:report.url||'N/A',totalRequests:totalRequests,successCount:successCount,errorCount:report.error_count||0,totalDuration:report.total_duration||0,qps:report.qps?report.qps:0,successPercentage:totalRequests>0?(successCount===totalRequests?100:(successCount===0?0:((successCount/totalRequests)*100).toFixed(1))):0,avgLatency:report.avg_latency||0,minLatency:report.min_latency||0,maxLatency:report.max_latency||0,p25Latency:report.p25_latency||0,p50Latency:report.p50_latency||0,p95Latency:report.p95_latency||0,p99Latency:report.p99_latency||0,totalSent:report.total_sent||0,totalReceived:report.total_received||0,agentStatusList:parseAgentStatus(report.status)};let statusCodesList='';if(report.status_codes&&Object.keys(report.status_codes).length>0){for(const[code,count]of Object.entries(report.status_codes)){statusCodesList+=`- ${code}: ${count}\n`}}else{statusCodesList=translations[currentLanguage].noErrors}reportData.statusCodesList=statusCodesList;let errorList=translations[currentLanguage].noErrors;if(report.errors&&report.errors.length>0){errorList=report.errors.map(error=>`- ${error}`).join('\n')}reportData.errorList=errorList;const markdownContent=translations[currentLanguage].markdownContent(reportData);const blob=new Blob([markdownContent],{type:'text/markdown;charset=utf-8'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`perftest-report-${reportData.testId}.md`;document.body.appendChild(a);a.click();setTimeout(()=>{document.body.removeChild(a);URL.revokeObjectURL(url)},100)}document.addEventListener('DOMContentLoaded',()=>{const savedLang=localStorage.getItem('perftest_language')||'zh';setLanguage(savedLang);restoreState()});createTestBtn.addEventListener('click',createTest);stopTestBtn.addEventListener('click',stopTest);downloadReportBtn.addEventListener('click',downloadReport);modalDownloadBtn.addEventListener('click',()=>{downloadReport();hideCompletionModal()});modalCloseBtn.addEventListener('click',hideCompletionModal);langToggleBtn.addEventListener('click',event=>{event.stopPropagation();langOptions.classList.toggle('show')});langOptions.addEventListener('click',event=>{if(event.target.tagName==='A'){const lang=event.target.getAttribute('data-lang');setLanguage(lang);langOptions.classList.remove('show')}});window.addEventListener('click',event=>{if(!langToggleBtn.contains(event.target)&&langOptions.classList.contains('show')){langOptions.classList.remove('show')}});window.addEventListener('beforeunload',()=>{saveState()});</script></body></html>
